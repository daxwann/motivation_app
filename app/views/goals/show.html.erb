<div>
  <h1>Goal: <%= @goal.title %></h1>
  <p>Author: <a href="<%= user_url(@goal.user_id) %>"><%= @goal.author.username %></a></p>
  <p>Detail:</p>
  <pre><%= @goal.detail %></pre>
  <% if @goal.completed %>
    <p>Completed</p>
  <% else %>
    <p>Not Completed</p>
  <% end %>
  <% if @goal.user_id == current_user.id %>
    <div>
      <a href="<%= edit_goal_url(@goal) %>">Edit</a>
    </div>
    <div>
      <form action="<%= goal_url(@goal) %>" method="POST">
        <%= auth_token %>
        <input type="hidden"
          name="_method"
          value="delete">
        <input type="submit"
          value="Delete">
      </form>
    </div>
  <% end %>
</div>
<div>
  <h2>Comments</h2>
  <% unless @goal.comments.empty? %>
    <% @goal.comments.each do |comment| %>
      <pre><%= comment.body %></pre>
      <p>- <%= comment.author.username %></p>
      <% if comment.author_id == current_user.id %>
        <div>
          <form action="<%= goal_comment_url(comment.id) %>" method="POST">
            <%= auth_token %>
            <input type="hidden"
              name="_method"
              value="delete">
            <input type="submit"
              value="Delete Comment">
          </form>
        </div>
      <% end %>
    <% end %>
  <% else %>
    <p>None</p>
  <% end %>
  <div>
    <form action="<%= goal_comments_url %>" method="POST">
      <%= auth_token %>
      <input type="hidden"
        name="goal_comment[goal_id]"
        value="<%= @goal.id %>">
      <div>
        <label for="goal_comment_body">New Comment</label>
        <textarea id="goal_comment_body"
          name="goal_comment[body]"><%= @comment.body %></textarea>
      </div>
      <input type="submit"
        value="Add Comment">
    </form>
  </div>
</div>
